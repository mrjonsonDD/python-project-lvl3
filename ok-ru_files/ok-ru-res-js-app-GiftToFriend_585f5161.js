define(["OK/utils/dom","OK/utils/utils","OK/utils/throttle","OK/utils/delegate","OK/SpriteAnimation"],(function(t,i,s,e,o){"use strict";var n=function(){};function r(t,i){t.style.cssText+="; transform: "+i+"; -webkit-transform: "+i+"; -moz-transform: "+i+"; -ms-transform: "+i+";"}return n.prototype.activate=function(i){if(this.hook=i,this.container=t.firstByClass(this.hook,"gift-to-friend_cnt"),this.sendBtn=t.firstByClass(this.hook,"js-send-btn"),this.previewHolder=t.firstByClass(this.hook,"gift-to-friend_preview_stub"),this.giftCards=t.byClass(this.hook,"gift-card"),this.delegator=new e(this.hook),this.spriteAnimation=null,this.giftCards){var s=this.giftCards[3];s&&(this.choosedGift=t.firstByClass(s,"gift_a"))}this.initHandlers()},n.prototype.initHandlers=function(){var e=this;this.delegator.on("mousedown",".gift-card:not(.__clone)",(function(){if(e.hook.classList.remove("__demo"),e.hook.classList.add("__has-choice"),!this.classList.contains("__no-anim")){if(e.choosedGift)t.firstByClass(e.hook,"__clone")&&t.firstByClass(e.hook,"__clone").remove();var i=this.offsetTop,s=this.offsetLeft,n=e.previewHolder.offsetTop,a=e.previewHolder.offsetLeft,h=n-i,c=a-s,d=this.cloneNode(!0);d.classList.add("__clone"),d.style.top=i+"px",d.style.left=s+"px",e.giftCards.forEach((function(t){t.classList.remove("__hidden")})),this.classList.add("__hidden"),e.container.appendChild(d),e.previewHolder.classList.add("__has-gift"),r(d,"translate(0,0)"),setTimeout((function(){r(d,"translate("+c+"px, "+h+"px)")}),200);var l=d.firstChild;l.classList.contains("__spriteAnimation")&&(e.spriteAnimation=new o,e.spriteAnimation.activate(l)),e.choosedGift=t.firstByClass(this,"gift_a"),e.sendBtn.classList.remove("__disabled")}})),this.sendBtnListener=function(){this.choosedGift&&(this.choosedGift.classList.add("__no-anim"),this.choosedGift.click())}.bind(this),this.sendBtn.addEventListener("click",this.sendBtnListener),this.checkVisibility=s(150,function(t){this.hook.classList.contains("__has-choice")?window.removeEventListener("scroll",this.checkVisibility):this.hook.classList.toggle("__demo",i.isElementInViewport(this.hook))}.bind(this)),this.checkVisibility(),window.addEventListener("scroll",this.checkVisibility)},n.prototype.deactivate=function(){this.delegator.destroy(),this.sendBtn.removeEventListener("click",this.sendBtnListener),window.removeEventListener("scroll",this.checkVisibility)},n}));
//# sourceMappingURL=/res/source-maps/js/app/GiftToFriend.js.map